# Upgrade v6.1.0 - Bulk Processing

-   **Date**: 2025-10-24
-   **Git tag**: [v6.1.0](https://github.com/iExecBlockchainComputing/PoCo/releases/tag/v6.1.0)
-   **Upgrade script**: `./v6.1.0-bulk-processing.ts`
-   **Upgrade GitHub Action run**: // TODO
    -   **Testnet**: [run id](https://github.com/iExecBlockchainComputing/PoCo/actions/runs/18775709142)
    -   **Mainnet**: [TODO](https://github.com/iExecBlockchainComputing/PoCo/actions/runs/<runId>)

## Summary of changes

-   Removes unintentionally added constants getters by changing constants visibility to `internal`.
    These functions were introduced as a side-effect of the migration to the Diamond proxy but they are
    used nowhere. They are duplicate of other existing functions: - `CONTRIBUTION_DEADLINE_RATIO()` - `FINAL_DEADLINE_RATIO()` - `GROUPMEMBER_PURPOSE()` - `KITTY_ADDRESS()` - `KITTY_MIN()` - `KITTY_RATIO()` - `REVEAL_DEADLINE_RATIO()` - `WORKERPOOL_STAKE_RATIO()`
-   Remove Boost facets from Arbitrum Sepolia to have the same setup on testnet and mainnet.
-   Add functions `viewApp`, `viewDataset`, and `viewWorkerpool` to read asset's details in a single transaction.
-   Add function `assertDatasetDealCompatibility` to allow the SMS to check compatibility of Bulk orders with a given deal.

## Deployment logs

### Arbitrum Sepolia

```
Performing bulk processing upgrade...
Network: arbitrumSepolia (421614) (isFork: false)
Deployer: 0x9990cfb1Feb7f47297F54bef4d4EbeDf6c5463a3
Owner: 0x9990cfb1Feb7f47297F54bef4d4EbeDf6c5463a3
IexecLibOrders_v5 address: 0x1Ecf986A719271846a04F095c426D90d564e4842
Diamond proxy address: 0xB2157BF2fAb286b2A4170E3491Ac39770111Da3E
Diamond proxy onchain owner: 0x9990cfb1Feb7f47297F54bef4d4EbeDf6c5463a3

ðŸ’Ž Diamond proxy has 17 facets with 107 total functions.
Facets:
   - DiamondCutFacet: 0x6A4ccf4414c438424d3FB5183f9048EDfbB47847
   - DiamondLoupeFacet: 0xf509a2221FCB63645d5b24c3740E35f219f30db9
   - IexecAccessorsABILegacyFacet: 0x56CDC32332648b1220a89172191798852706EB35
   - IexecAccessorsFacet: 0xEa232be31ab0112916505Aeb7A2a94b5571DCc6b
   - IexecCategoryManagerFacet: 0x5f0483b9D7f959816A5CDD4C49E5C91C24561B43
   - IexecConfigurationExtraFacet: 0x7Ff117E7385Ac3E207AF1791fE7e66C7802aeCCd
   - IexecConfigurationFacet: 0x88eb05e62434057d3AA9e41FdaF7300A586b314D
   - IexecERC20Facet: 0xB0152eC6f48E64a92B66D4736aFA1b02d8D45169
   - IexecEscrowTokenFacet: 0xd9EB17A161581FBBAD2Ae998c0C19746EaAD0D6E
   - IexecOrderManagementFacet: 0x541d532E6C195Ba044a75325F367342f523627fB
   - IexecPoco1Facet: 0xB670bf6165f1Df353CeA45AFB622dd91EA973AB9
   - IexecPoco2Facet: 0x5c7B589E6807B554ed278f335215B93bCB692162
   - IexecPocoAccessorsFacet: 0x6C56FFFd001939d03779929702B2722C904a34da
   - IexecPocoBoostAccessorsFacet: 0xa23ABb680ecc9D2A51a0CcDE88604552340786Ae
   - IexecPocoBoostFacet: 0x248df8EFE953B39f965e5C7272283096d20f5956
   - IexecRelayFacet: 0x8cBf58265F74b77f0D9cCA9f7e14685205496d8f
   - OwnershipFacet: 0x606CfE8BabBd286329281f14895634F913BfdB76
Functions:
   - 0x4ec3b9e3 -> IexecAccessorsFacet
   - 0x51152de1 -> IexecAccessorsFacet
   - 0x5fde601d -> IexecAccessorsFacet
   - 0x68a9ef1c -> IexecAccessorsFacet
   - 0x7b244832 -> IexecAccessorsFacet
   - 0x90fc26b1 -> IexecAccessorsFacet
   - 0x9e986e81 -> IexecAccessorsFacet
   - 0xe2e7a8c1 -> IexecAccessorsFacet
   - allowance -> IexecAccessorsFacet
   - appregistry -> IexecAccessorsFacet
   - approve -> IexecERC20Facet
   - approveAndCall -> IexecERC20Facet
   - balanceOf -> IexecAccessorsFacet
   - broadcastAppOrder -> IexecRelayFacet
   - broadcastDatasetOrder -> IexecRelayFacet
   - broadcastRequestOrder -> IexecRelayFacet
   - broadcastWorkerpoolOrder -> IexecRelayFacet
   - callbackgas -> IexecAccessorsFacet
   - changeRegistries -> IexecConfigurationExtraFacet
   - claim -> IexecPoco2Facet
   - claimArray -> IexecPoco2Facet
   - claimBoost -> IexecPocoBoostFacet
   - computeDealVolume -> IexecPocoAccessorsFacet
   - configure -> IexecConfigurationFacet
   - contribute -> IexecPoco2Facet
   - contributeAndFinalize -> IexecPoco2Facet
   - contribution_deadline_ratio -> IexecAccessorsFacet
   - countCategory -> IexecAccessorsFacet
   - createCategory -> IexecCategoryManagerFacet
   - datasetregistry -> IexecAccessorsFacet
   - decimals -> IexecAccessorsFacet
   - decreaseAllowance -> IexecERC20Facet
   - deposit -> IexecEscrowTokenFacet
   - depositFor -> IexecEscrowTokenFacet
   - depositForArray -> IexecEscrowTokenFacet
   - diamondCut -> DiamondCutFacet
   - domain -> IexecConfigurationFacet
   - eip712domain_separator -> IexecAccessorsFacet
   - facetAddress -> DiamondLoupeFacet
   - facetAddresses -> DiamondLoupeFacet
   - facetFunctionSelectors -> DiamondLoupeFacet
   - facets -> DiamondLoupeFacet
   - fallback -> IexecEscrowTokenFacet
   - final_deadline_ratio -> IexecAccessorsFacet
   - finalize -> IexecPoco2Facet
   - frozenOf -> IexecAccessorsFacet
   - groupmember_purpose -> IexecAccessorsFacet
   - importScore -> IexecConfigurationFacet
   - increaseAllowance -> IexecERC20Facet
   - initialize -> IexecPoco2Facet
   - initializeAndClaimArray -> IexecPoco2Facet
   - initializeArray -> IexecPoco2Facet
   - kitty_address -> IexecAccessorsFacet
   - kitty_min -> IexecAccessorsFacet
   - kitty_ratio -> IexecAccessorsFacet
   - manageAppOrder -> IexecOrderManagementFacet
   - manageDatasetOrder -> IexecOrderManagementFacet
   - manageRequestOrder -> IexecOrderManagementFacet
   - manageWorkerpoolOrder -> IexecOrderManagementFacet
   - matchOrders -> IexecPoco1Facet
   - matchOrdersBoost -> IexecPocoBoostFacet
   - name -> IexecAccessorsFacet
   - owner -> OwnershipFacet
   - pushResultBoost -> IexecPocoBoostFacet
   - receive -> IexecEscrowTokenFacet
   - receiveApproval -> IexecEscrowTokenFacet
   - recover -> IexecEscrowTokenFacet
   - reopen -> IexecPoco2Facet
   - resultFor -> IexecAccessorsFacet
   - reveal -> IexecPoco2Facet
   - reveal_deadline_ratio -> IexecAccessorsFacet
   - setCallbackGas -> IexecConfigurationFacet
   - setTeeBroker -> IexecConfigurationFacet
   - sponsorMatchOrders -> IexecPoco1Facet
   - sponsorMatchOrdersBoost -> IexecPocoBoostFacet
   - supportsInterface -> DiamondLoupeFacet
   - symbol -> IexecAccessorsFacet
   - teebroker -> IexecAccessorsFacet
   - token -> IexecAccessorsFacet
   - totalSupply -> IexecAccessorsFacet
   - transfer -> IexecERC20Facet
   - transferFrom -> IexecERC20Facet
   - transferOwnership -> OwnershipFacet
   - updateDomainSeparator -> IexecConfigurationFacet
   - verifyPresignature -> IexecPoco1Facet
   - verifyPresignatureOrSignature -> IexecPoco1Facet
   - verifySignature -> IexecPoco1Facet
   - viewAccount -> IexecAccessorsFacet
   - viewAccountABILegacy -> IexecAccessorsABILegacyFacet
   - viewCategory -> IexecAccessorsFacet
   - viewCategoryABILegacy -> IexecAccessorsABILegacyFacet
   - viewConfigABILegacy -> IexecAccessorsABILegacyFacet
   - viewConsumed -> IexecAccessorsFacet
   - viewContribution -> IexecAccessorsFacet
   - viewContributionABILegacy -> IexecAccessorsABILegacyFacet
   - viewDeal -> IexecAccessorsFacet
   - viewDealABILegacy_pt1 -> IexecAccessorsABILegacyFacet
   - viewDealABILegacy_pt2 -> IexecAccessorsABILegacyFacet
   - viewDealBoost -> IexecPocoBoostAccessorsFacet
   - viewPresigned -> IexecAccessorsFacet
   - viewScore -> IexecAccessorsFacet
   - viewTask -> IexecAccessorsFacet
   - viewTaskABILegacy -> IexecAccessorsABILegacyFacet
   - withdraw -> IexecEscrowTokenFacet
   - withdrawTo -> IexecEscrowTokenFacet
   - workerpool_stake_ratio -> IexecAccessorsFacet
   - workerpoolregistry -> IexecAccessorsFacet

=== Deploying new facets ===
â†’ CreateX is available on this network at 0xba5Ed099633D3B313e4D5F7bdc1305d3c28ba5Ed
Deploying IexecPoco1Facet at 0xC8dE3913fcdBC576970dCe24eE416CA25681f65f
IexecPoco1Facet: 0xC8dE3913fcdBC576970dCe24eE416CA25681f65f
Deploying IexecPocoAccessorsFacet at 0x56625089E6EB6F058DB163025318575AD38781fa
IexecPocoAccessorsFacet: 0x56625089E6EB6F058DB163025318575AD38781fa
Facets deployed successfully!

=== Removing whole facets from diamond ===
Will remove facet [name:IexecAccessorsFacet, address: 0xEa232be31ab0112916505Aeb7A2a94b5571DCc6b, functions:40]
Will remove facet [name:IexecPoco1Facet, address: 0xB670bf6165f1Df353CeA45AFB622dd91EA973AB9, functions:5]
Will remove facet [name:IexecPocoAccessorsFacet, address: 0x6C56FFFd001939d03779929702B2722C904a34da, functions:1]
Will remove facet [name:IexecPocoBoostAccessorsFacet, address: 0xa23ABb680ecc9D2A51a0CcDE88604552340786Ae, functions:1]
Will remove facet [name:IexecPocoBoostFacet, address: 0x248df8EFE953B39f965e5C7272283096d20f5956, functions:4]
Executing diamond cut to remove 5 facets
Transaction hash: 0x83ae07ce9ef30767397ce54efad3ab538b524a44b9e09278cec2d85cbfbd51b1
Facets removed successfully!

ðŸ’Ž Diamond proxy has 12 facets with 56 total functions.
Facets:
   - DiamondCutFacet: 0x6A4ccf4414c438424d3FB5183f9048EDfbB47847
   - DiamondLoupeFacet: 0xf509a2221FCB63645d5b24c3740E35f219f30db9
   - IexecAccessorsABILegacyFacet: 0x56CDC32332648b1220a89172191798852706EB35
   - IexecCategoryManagerFacet: 0x5f0483b9D7f959816A5CDD4C49E5C91C24561B43
   - IexecConfigurationExtraFacet: 0x7Ff117E7385Ac3E207AF1791fE7e66C7802aeCCd
   - IexecConfigurationFacet: 0x88eb05e62434057d3AA9e41FdaF7300A586b314D
   - IexecERC20Facet: 0xB0152eC6f48E64a92B66D4736aFA1b02d8D45169
   - IexecEscrowTokenFacet: 0xd9EB17A161581FBBAD2Ae998c0C19746EaAD0D6E
   - IexecOrderManagementFacet: 0x541d532E6C195Ba044a75325F367342f523627fB
   - IexecPoco2Facet: 0x5c7B589E6807B554ed278f335215B93bCB692162
   - IexecRelayFacet: 0x8cBf58265F74b77f0D9cCA9f7e14685205496d8f
   - OwnershipFacet: 0x606CfE8BabBd286329281f14895634F913BfdB76
Functions:
   - approve -> IexecERC20Facet
   - approveAndCall -> IexecERC20Facet
   - broadcastAppOrder -> IexecRelayFacet
   - broadcastDatasetOrder -> IexecRelayFacet
   - broadcastRequestOrder -> IexecRelayFacet
   - broadcastWorkerpoolOrder -> IexecRelayFacet
   - changeRegistries -> IexecConfigurationExtraFacet
   - claim -> IexecPoco2Facet
   - claimArray -> IexecPoco2Facet
   - configure -> IexecConfigurationFacet
   - contribute -> IexecPoco2Facet
   - contributeAndFinalize -> IexecPoco2Facet
   - createCategory -> IexecCategoryManagerFacet
   - decreaseAllowance -> IexecERC20Facet
   - deposit -> IexecEscrowTokenFacet
   - depositFor -> IexecEscrowTokenFacet
   - depositForArray -> IexecEscrowTokenFacet
   - diamondCut -> DiamondCutFacet
   - domain -> IexecConfigurationFacet
   - facetAddress -> DiamondLoupeFacet
   - facetAddresses -> DiamondLoupeFacet
   - facetFunctionSelectors -> DiamondLoupeFacet
   - facets -> DiamondLoupeFacet
   - fallback -> IexecEscrowTokenFacet
   - finalize -> IexecPoco2Facet
   - importScore -> IexecConfigurationFacet
   - increaseAllowance -> IexecERC20Facet
   - initialize -> IexecPoco2Facet
   - initializeAndClaimArray -> IexecPoco2Facet
   - initializeArray -> IexecPoco2Facet
   - manageAppOrder -> IexecOrderManagementFacet
   - manageDatasetOrder -> IexecOrderManagementFacet
   - manageRequestOrder -> IexecOrderManagementFacet
   - manageWorkerpoolOrder -> IexecOrderManagementFacet
   - owner -> OwnershipFacet
   - receive -> IexecEscrowTokenFacet
   - receiveApproval -> IexecEscrowTokenFacet
   - recover -> IexecEscrowTokenFacet
   - reopen -> IexecPoco2Facet
   - reveal -> IexecPoco2Facet
   - setCallbackGas -> IexecConfigurationFacet
   - setTeeBroker -> IexecConfigurationFacet
   - supportsInterface -> DiamondLoupeFacet
   - transfer -> IexecERC20Facet
   - transferFrom -> IexecERC20Facet
   - transferOwnership -> OwnershipFacet
   - updateDomainSeparator -> IexecConfigurationFacet
   - viewAccountABILegacy -> IexecAccessorsABILegacyFacet
   - viewCategoryABILegacy -> IexecAccessorsABILegacyFacet
   - viewConfigABILegacy -> IexecAccessorsABILegacyFacet
   - viewContributionABILegacy -> IexecAccessorsABILegacyFacet
   - viewDealABILegacy_pt1 -> IexecAccessorsABILegacyFacet
   - viewDealABILegacy_pt2 -> IexecAccessorsABILegacyFacet
   - viewTaskABILegacy -> IexecAccessorsABILegacyFacet
   - withdraw -> IexecEscrowTokenFacet
   - withdrawTo -> IexecEscrowTokenFacet

=== Linking facets to diamond proxy ===
Linking facet IexecPoco1Facet to diamond proxy
Linking facet IexecPocoAccessorsFacet to diamond proxy
Facets linked successfully!

ðŸ’Ž Diamond proxy has 14 facets with 98 total functions.
Facets:
   - DiamondCutFacet: 0x6A4ccf4414c438424d3FB5183f9048EDfbB47847
   - DiamondLoupeFacet: 0xf509a2221FCB63645d5b24c3740E35f219f30db9
   - IexecAccessorsABILegacyFacet: 0x56CDC32332648b1220a89172191798852706EB35
   - IexecCategoryManagerFacet: 0x5f0483b9D7f959816A5CDD4C49E5C91C24561B43
   - IexecConfigurationExtraFacet: 0x7Ff117E7385Ac3E207AF1791fE7e66C7802aeCCd
   - IexecConfigurationFacet: 0x88eb05e62434057d3AA9e41FdaF7300A586b314D
   - IexecERC20Facet: 0xB0152eC6f48E64a92B66D4736aFA1b02d8D45169
   - IexecEscrowTokenFacet: 0xd9EB17A161581FBBAD2Ae998c0C19746EaAD0D6E
   - IexecOrderManagementFacet: 0x541d532E6C195Ba044a75325F367342f523627fB
   - IexecPoco1Facet: 0xC8dE3913fcdBC576970dCe24eE416CA25681f65f
   - IexecPoco2Facet: 0x5c7B589E6807B554ed278f335215B93bCB692162
   - IexecPocoAccessorsFacet: 0x56625089E6EB6F058DB163025318575AD38781fa
   - IexecRelayFacet: 0x8cBf58265F74b77f0D9cCA9f7e14685205496d8f
   - OwnershipFacet: 0x606CfE8BabBd286329281f14895634F913BfdB76
Functions:
   - allowance -> IexecPocoAccessorsFacet
   - appregistry -> IexecPocoAccessorsFacet
   - approve -> IexecERC20Facet
   - approveAndCall -> IexecERC20Facet
   - assertDatasetDealCompatibility -> IexecPoco1Facet
   - balanceOf -> IexecPocoAccessorsFacet
   - broadcastAppOrder -> IexecRelayFacet
   - broadcastDatasetOrder -> IexecRelayFacet
   - broadcastRequestOrder -> IexecRelayFacet
   - broadcastWorkerpoolOrder -> IexecRelayFacet
   - callbackgas -> IexecPocoAccessorsFacet
   - changeRegistries -> IexecConfigurationExtraFacet
   - claim -> IexecPoco2Facet
   - claimArray -> IexecPoco2Facet
   - computeDealVolume -> IexecPocoAccessorsFacet
   - configure -> IexecConfigurationFacet
   - contribute -> IexecPoco2Facet
   - contributeAndFinalize -> IexecPoco2Facet
   - contribution_deadline_ratio -> IexecPocoAccessorsFacet
   - countCategory -> IexecPocoAccessorsFacet
   - createCategory -> IexecCategoryManagerFacet
   - datasetregistry -> IexecPocoAccessorsFacet
   - decimals -> IexecPocoAccessorsFacet
   - decreaseAllowance -> IexecERC20Facet
   - deposit -> IexecEscrowTokenFacet
   - depositFor -> IexecEscrowTokenFacet
   - depositForArray -> IexecEscrowTokenFacet
   - diamondCut -> DiamondCutFacet
   - domain -> IexecConfigurationFacet
   - eip712domain_separator -> IexecPocoAccessorsFacet
   - facetAddress -> DiamondLoupeFacet
   - facetAddresses -> DiamondLoupeFacet
   - facetFunctionSelectors -> DiamondLoupeFacet
   - facets -> DiamondLoupeFacet
   - fallback -> IexecEscrowTokenFacet
   - final_deadline_ratio -> IexecPocoAccessorsFacet
   - finalize -> IexecPoco2Facet
   - frozenOf -> IexecPocoAccessorsFacet
   - groupmember_purpose -> IexecPocoAccessorsFacet
   - importScore -> IexecConfigurationFacet
   - increaseAllowance -> IexecERC20Facet
   - initialize -> IexecPoco2Facet
   - initializeAndClaimArray -> IexecPoco2Facet
   - initializeArray -> IexecPoco2Facet
   - kitty_address -> IexecPocoAccessorsFacet
   - kitty_min -> IexecPocoAccessorsFacet
   - kitty_ratio -> IexecPocoAccessorsFacet
   - manageAppOrder -> IexecOrderManagementFacet
   - manageDatasetOrder -> IexecOrderManagementFacet
   - manageRequestOrder -> IexecOrderManagementFacet
   - manageWorkerpoolOrder -> IexecOrderManagementFacet
   - matchOrders -> IexecPoco1Facet
   - name -> IexecPocoAccessorsFacet
   - owner -> OwnershipFacet
   - receive -> IexecEscrowTokenFacet
   - receiveApproval -> IexecEscrowTokenFacet
   - recover -> IexecEscrowTokenFacet
   - reopen -> IexecPoco2Facet
   - resultFor -> IexecPocoAccessorsFacet
   - reveal -> IexecPoco2Facet
   - reveal_deadline_ratio -> IexecPocoAccessorsFacet
   - setCallbackGas -> IexecConfigurationFacet
   - setTeeBroker -> IexecConfigurationFacet
   - sponsorMatchOrders -> IexecPoco1Facet
   - supportsInterface -> DiamondLoupeFacet
   - symbol -> IexecPocoAccessorsFacet
   - teebroker -> IexecPocoAccessorsFacet
   - token -> IexecPocoAccessorsFacet
   - totalSupply -> IexecPocoAccessorsFacet
   - transfer -> IexecERC20Facet
   - transferFrom -> IexecERC20Facet
   - transferOwnership -> OwnershipFacet
   - updateDomainSeparator -> IexecConfigurationFacet
   - verifyPresignature -> IexecPoco1Facet
   - verifyPresignatureOrSignature -> IexecPoco1Facet
   - verifySignature -> IexecPoco1Facet
   - viewAccount -> IexecPocoAccessorsFacet
   - viewAccountABILegacy -> IexecAccessorsABILegacyFacet
   - viewApp -> IexecPocoAccessorsFacet
   - viewCategory -> IexecPocoAccessorsFacet
   - viewCategoryABILegacy -> IexecAccessorsABILegacyFacet
   - viewConfigABILegacy -> IexecAccessorsABILegacyFacet
   - viewConsumed -> IexecPocoAccessorsFacet
   - viewContribution -> IexecPocoAccessorsFacet
   - viewContributionABILegacy -> IexecAccessorsABILegacyFacet
   - viewDataset -> IexecPocoAccessorsFacet
   - viewDeal -> IexecPocoAccessorsFacet
   - viewDealABILegacy_pt1 -> IexecAccessorsABILegacyFacet
   - viewDealABILegacy_pt2 -> IexecAccessorsABILegacyFacet
   - viewPresigned -> IexecPocoAccessorsFacet
   - viewScore -> IexecPocoAccessorsFacet
   - viewTask -> IexecPocoAccessorsFacet
   - viewTaskABILegacy -> IexecAccessorsABILegacyFacet
   - viewWorkerpool -> IexecPocoAccessorsFacet
   - withdraw -> IexecEscrowTokenFacet
   - withdrawTo -> IexecEscrowTokenFacet
   - workerpool_stake_ratio -> IexecPocoAccessorsFacet
   - workerpoolregistry -> IexecPocoAccessorsFacet
Upgrade performed successfully!
Saved diamond proxy description to deployments/arbitrumSepolia/.diamond.log

=== Removing dangling deployment artifacts ===
Deleting dangling facet artifact [name:IexecAccessorsFacet, address:0xEa232be31ab0112916505Aeb7A2a94b5571DCc6b]
Deleting dangling facet artifact [name:IexecPocoBoostAccessorsFacet, address:0xa23ABb680ecc9D2A51a0CcDE88604552340786Ae]
Deleting dangling facet artifact [name:IexecPocoBoostFacet, address:0x248df8EFE953B39f965e5C7272283096d20f5956]

=== Verifying contracts on block explorer ===
Contracts to verify: IexecPoco1Facet, IexecPocoAccessorsFacet
Waiting for block explorer to index the contracts...
Error verifying IexecPoco1Facet: You are using a deprecated V1 endpoint, switch to Etherscan API V2 using https://docs.etherscan.io/v2-migration
Error verifying IexecPocoAccessorsFacet: You are using a deprecated V1 endpoint, switch to Etherscan API V2 using https://docs.etherscan.io/v2-migration

Verification completed!

```

### Arbitrum Mainnet

```
TODO
```
